<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <link rel="icon" type="image/png" href="image/logotrue.png">
    <title>Технопарк-Экскурсия</title>
    <style>
      #lvl1{
        display: block;
      }
      #lvl2{
        display: none;
      }
      #lvl3{
        display: none;
      }
      #zatemnenie {
        background-color: #32324E;
        width: 100%;
        height: 100%;
        position: absolute;
        top: 0;
        left: 0;
      }
      #moneti {
        width: 100px;
        height: 50px;
        text-align: center;
        padding: 15px;
        border: 3px solid #0000cc;
        border-radius: 10px;
        color: #0000cc;
        position: fixed;
        top: 10px;
        right: 10px;
        background: #fff;
       }
      #okno {
        width: 1000px;
        height: 900px;
        text-align: center;
        padding: 15px;
        border: 3px solid #0000cc;
        border-radius: 10px;
        color: #0000cc;
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        margin: auto;
        background: #fff;
      }
      .my-button {
        position: absolute;
        top: 80%;
        right: 83%;
        transform: translate(-50%, -50%);
        background-color: #4CAF50;
        border: none;
        color: white;
        padding: 45px 43px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        cursor: pointer;
        opacity: 0;
      }
      .my-button2 {
        position: absolute;
        top: 66%;
        right: 82%;
        transform: translate(-50%, -50%);
        background-color: #4CAF50;
        border: none;
        color: white;
        padding: 45px 43px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        cursor: pointer;
        opacity: 0;
        pointer-events: none;
      }
      #okno2 {
        width: 500px;
        height: 250px;
        text-align: center;
        padding: 15px;
        border: 3px solid #0000cc;
        border-radius: 10px;
        color: #0000cc;
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        margin: auto;
        background: #fff;
        display: none;
      }
      #okno3 {
        width: 500px;
        height: 300px;
        text-align: center;
        padding: 15px;
        border: 3px solid #0000cc;
        border-radius: 10px;
        color: #0000cc;
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        margin: auto;
        background: #fff;
        display: none;
      }
      .my-button3 {
        position: absolute;
        top: 86%;
        left: 75%;
        transform: translate(-50%, -50%);
        border: none;
        color: white;
        padding: 10px 10px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        cursor: pointer;
      }
      .my-button4 {
        position: absolute;
        top: 86%;
        right: 34%;
        transform: translate(-50%, -50%);
        border: none;
        color: white;
        padding: 10px 10px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        cursor: pointer;
      }
      .my-button5  {
        position: absolute;
        top: 75%;
        left: 75%;
        transform: translate(-50%, -50%);
        background-color: #4CAF50;
        border: none;
        color: white;
        padding: 45px 43px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        cursor: pointer;
      }
      .my-button6 {
        position: absolute;
        top: 75%;
        left: 75%;
        transform: translate(-50%, -50%);
        border: none;
        color: white;
        padding: 10px 10px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        cursor: pointer;
      }
      .my-button7 {
        position: absolute;
        top: 75%;
        right: 34%;
        transform: translate(-50%, -50%);
        border: none;
        color: white;
        padding: 10px 10px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        cursor: pointer;
      }
  </style>
</head>
<body>
  <div id="zatemnenie">
  </div>
  <div id="okno">    
    <img class="lvl1" src="image/lvl1.png" width=1000 height=900 >
    <img class="lvl2" src="image/lvl2.png" width=1000 height=900 >
    <img class="lvl3" src="image/lvl3.png" width=1000 height=900 >
    <a href="#" class="my-button" onclick="openWindow()"></a>
    <a href="#" class="my-button2" onclick="openWindow3()"></a>
  </div>

  <div id="okno2">
    второй этаж оформлен под Венеру — на стене вы видите описание и интересные факты о планете. Здесь для резидентов обустроен фуд-корт.<br>
    А еще по соседству разместилась «Точка кипения» — пространство для бесплатного проведения лекций, собраний, интерактивных мероприятий.<br>
    <a href="#" class="my-button7" onclick="addCoinAndNavigate2()">
      <img src="image/seen.png" alt="посмотреть" width=200 height=70>
    </a>
    <a href="#" class="my-button6" onclick="closeWindow()">
      <img src="image/butclose.png" alt="закрыть" width=200 height=70>
    </a>
  </div>
  <div id="okno3">
    На третьем этаже в настоящее время размещается Республиканская юношеская библиотека, поэтому со второго этажа мы переходим сразу на четвертый. Почти на каждом уровне IT-парка расположены
    офисы для компаний.<br>
    На четвертом этаже, или этаже Марса, есть полезные для резидентов студии: VR-студия, где можно окунуться в виртуальную реальность, а также студия захвата движений, что может понадобиться разработчикам компьютерных игр.<br>
    Также на этом этаже находится большая кухня, где ребята могут приготовить себе что-нибудь на обед или просто попить кофе. Но самое интересное в ней это маленькая гидропонная установка, в которой можно выращивать зелень сразу на стол.<br>
    <a href="#" class="my-button4" onclick="addCoinAndNavigate()">
      <img src="image/seen.png" alt="Кнопка" width=200 height=70>
    </a>
    <a href="#" class="my-button3" onclick="closeWindow2()">
      <img src="image/butclose.png" alt="закрыть" width=200 height=70>
    </a>
  </div>
  <div id="moneti">
    <script>   
      function updateCoinCount() {
        var monetiElement = document.getElementById('moneti');
        if (monetiElement) {
          var request = indexedDB.open('coinDatabase', 1);
          request.onsuccess = function (event) {
            var db = event.target.result;
            var transaction = db.transaction(['coins'], 'readonly');
            var objectStore = transaction.objectStore('coins');
            var getRequest = objectStore.get(1);
    
            getRequest.onsuccess = function (event) {
              var data = event.target.result;
              coinCount = data ? data.count : 0;
              monetiElement.innerText = 'Количество монет: ' + coinCount;
            };
          };
        }
      }
    
      updateCoinCount();
    </script>
  </div>

  <script>
    var coinCount = parseInt(localStorage.getItem('coinCount')) || 1;
    var db;
    

    if (!window.indexedDB) {
      console.log("Ваш браузер не поддерживает IndexedDB.");
    }

    var request = indexedDB.open('coinDatabase', 1);

    request.onupgradeneeded = function(event) {
      db = event.target.result;
      var objectStore = db.createObjectStore('coins', { keyPath: 'id', autoIncrement: true });
    };

    request.onsuccess = function(event) {
      db = event.target.result;
      if (db) {
        var transaction = db.transaction(['coins'], 'readwrite');
        var objectStore = transaction.objectStore('coins');

        var getRequest = objectStore.get(1);

        getRequest.onsuccess = function(event) {
          var data = event.target.result;
          if (data) {
            coinCount = data.count;
            updateCoinCount();
          }
        };
      }
    };

    function addCoinAndNavigate() {
      coinCount = parseInt(coinCount) + 1;
      console.log('Монета добавлена. Текущее количество монет:', coinCount);

      if (db) {
        updateCoinCountInDatabase();
        navigateToExternalSite();
      } else {
        console.error('База данных не готова.');
      }
    }

    function updateCoinCountInDatabase() {
      var transaction = db.transaction(['coins'], 'readwrite');
      var objectStore = transaction.objectStore('coins');

      var putRequest = objectStore.put({ id: 1, count: coinCount });

      putRequest.onsuccess = function(event) {
        console.log('Успешно обновлен счетчик монет в базе данных.');
        coinCount = putRequest.result.count;
        updateCoinCount();
        
      };

      putRequest.onerror = function(event) {
        console.error('Ошибка при обновлении счетчика монет в базе данных:', event.target.error);
      };
    }

    function navigateToExternalSite() {
      window.open('https://uploads.knightlab.com/scenevr/446/cc5eb250/index.html', '_blank');
    }

    function navigateToExternalSite2() {
      window.open('https://uploads.knightlab.com/scenevr/446/04702600/index.html', '_blank');
    }
    function addCoinAndNavigate2(){
      coinCount = parseInt(coinCount) + 1;
      console.log('Монета добавлена. Текущее количество монет:', coinCount);

      if (db) {
        updateCoinCountInDatabase();
        navigateToExternalSite2();
      } else {
        console.error('База данных не готова.');
      }
    }

    function closeWindow() {
      var okno2 = document.getElementById('okno2');
      okno2.style.display = 'none';
    }

    function openWindow() {
      var okno2 = document.getElementById('okno2');
      okno2.style.display = 'block';
    }

    function closeWindow2() {
      var okno3 = document.getElementById('okno3');
      okno3.style.display = 'none';
    }

    function openWindow3() {
      var okno3 = document.getElementById('okno3');
      okno3.style.display = 'block';
    }
    function lvl10() {
      var lvl1 = document.querySelector('.lvl1'); 
        lvl1.style.display = 'none';
      var lvl2 = document.querySelector('.lvl2');
        lvl2.style.display = 'block';
      var button = document.querySelector('.my-button2');
        button.style.pointerEvents = 'auto';
      }
      function lvl20() {
        var lvl1 = document.querySelector('.lvl1');
          lvl1.style.display = 'none';
        var lvl2 = document.querySelector('.lvl2');
          lvl2.style.display = 'block';
        }

      function lvl30() {
        var lvl2 = document.querySelector('.lvl2');
          lvl2.style.display = 'none';
        var lvl3 = document.querySelector('.lvl3');
          lvl3.style.display = 'block';
        }
    if (coinCount=>5) {
      lvl10();
    }
    if (coinCount=>10) {
      lvl20();
    }
    if (coinCount=>20) {
      lvl30();
    }
  </script>
</body>
</html>